--
-- PostgreSQL database dump
--

SET statement_timeout = 0;
SET lock_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SET check_function_bodies = false;
SET client_min_messages = warning;

--
-- Name: plpgsql; Type: EXTENSION; Schema: -; Owner: 
--

CREATE EXTENSION IF NOT EXISTS plpgsql WITH SCHEMA pg_catalog;


--
-- Name: EXTENSION plpgsql; Type: COMMENT; Schema: -; Owner: 
--

COMMENT ON EXTENSION plpgsql IS 'PL/pgSQL procedural language';


--
-- Name: uuid-ossp; Type: EXTENSION; Schema: -; Owner: 
--

CREATE EXTENSION IF NOT EXISTS "uuid-ossp" WITH SCHEMA public;


--
-- Name: EXTENSION "uuid-ossp"; Type: COMMENT; Schema: -; Owner: 
--

COMMENT ON EXTENSION "uuid-ossp" IS 'generate universally unique identifiers (UUIDs)';


SET search_path = public, pg_catalog;

SET default_tablespace = '';

SET default_with_oids = false;

--
-- Name: rules; Type: TABLE; Schema: public; Owner: postgres; Tablespace: 
--

CREATE TABLE rules (
    rule uuid NOT NULL,
    rule_desc text
);


ALTER TABLE public.rules OWNER TO postgres;

--
-- Name: rules_p; Type: TABLE; Schema: public; Owner: postgres; Tablespace: 
--

CREATE TABLE rules_p (
    rule uuid NOT NULL,
    rule_role text NOT NULL,
    action text,
    rule_group name
);


ALTER TABLE public.rules_p OWNER TO postgres;

--
-- Name: sys_group_user; Type: TABLE; Schema: public; Owner: postgres; Tablespace: 
--

CREATE TABLE sys_group_user (
    group_id uuid,
    user_id name
);


ALTER TABLE public.sys_group_user OWNER TO postgres;

--
-- Name: sys_groups; Type: TABLE; Schema: public; Owner: postgres; Tablespace: 
--

CREATE TABLE sys_groups (
    id uuid NOT NULL,
    name name
);


ALTER TABLE public.sys_groups OWNER TO postgres;

--
-- Name: sys_groups_struct; Type: TABLE; Schema: public; Owner: postgres; Tablespace: 
--

CREATE TABLE sys_groups_struct (
    group_id uuid NOT NULL,
    parent_id uuid,
    level integer
);


ALTER TABLE public.sys_groups_struct OWNER TO postgres;

--
-- Name: sys_users; Type: TABLE; Schema: public; Owner: postgres; Tablespace: 
--

CREATE TABLE sys_users (
    id name NOT NULL,
    id_group text,
    id_parent text,
    "position" name,
    name name
);


ALTER TABLE public.sys_users OWNER TO postgres;

--
-- Name: test; Type: TABLE; Schema: public; Owner: postgres; Tablespace: 
--

CREATE TABLE test (
    num integer,
    rule name
);


ALTER TABLE public.test OWNER TO postgres;

--
-- Name: test_table_protected; Type: TABLE; Schema: public; Owner: postgres; Tablespace: 
--

CREATE TABLE test_table_protected (
    field1 name,
    field2 name,
    rule uuid
);


ALTER TABLE public.test_table_protected OWNER TO postgres;

--
-- Name: test_table; Type: VIEW; Schema: public; Owner: postgres
--

CREATE VIEW test_table AS
 SELECT test_table_protected.field1,
    test_table_protected.field2,
    test_table_protected.rule
   FROM test_table_protected;


ALTER TABLE public.test_table OWNER TO postgres;

--
-- Name: testtable_protected; Type: TABLE; Schema: public; Owner: postgres; Tablespace: 
--

CREATE TABLE testtable_protected (
    name character(1)[],
    rule uuid
);


ALTER TABLE public.testtable_protected OWNER TO postgres;

--
-- Name: testtable; Type: VIEW; Schema: public; Owner: postgres
--

CREATE VIEW testtable AS
 SELECT testtable_protected.name,
    testtable_protected.rule
   FROM testtable_protected;


ALTER TABLE public.testtable OWNER TO postgres;

--
-- Data for Name: rules; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY rules (rule, rule_desc) FROM stdin;
a7c85b3d-54b3-4442-4410-58bacc2cfbc9	Документ_2
4e3e5ce2-4109-4c2d-adf2-3a215035bb22	Документ_1
\.


--
-- Data for Name: rules_p; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY rules_p (rule, rule_role, action, rule_group) FROM stdin;
a7c85b3d-54b3-4442-4410-58bacc2cfbc9	stud12	insert	\N
a7c85b3d-54b3-4442-4410-58bacc2cfbc9	admin	insert	\N
4e3e5ce2-4109-4c2d-adf2-3a215035bb22	admin	select	fc6ae330-4a2d-40b6-a46c-fb23a9fd83e2
4e3e5ce2-4109-4c2d-adf2-3a215035bb22	stid2	select	fc6ae330-4a2d-40b6-a46c-fb23a9fd83e2
4e3e5ce2-4109-4c2d-adf2-3a215035bb22	stud12	select	fc6ae330-4a2d-40b6-a46c-fb23a9fd83e2
\.


--
-- Data for Name: sys_group_user; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY sys_group_user (group_id, user_id) FROM stdin;
3294a3ba-ccca-4e15-4aa8-b9d7d17894dc	admin
fc6ae330-4a2d-40b6-a46c-fb23a9fd83e2	admin
fc6ae330-4a2d-40b6-a46c-fb23a9fd83e2	stid2
fc6ae330-4a2d-40b6-a46c-fb23a9fd83e2	stud12
9a5942d9-4de5-49cc-787c-479bbe6c84bc	admin
9a5942d9-4de5-49cc-787c-479bbe6c84bc	stid2
70959605-c4d9-41c3-be33-f151e72365b5	stud12
a6c7b9ee-278e-49f1-7dee-2e6186ab3cb8	admin
a6c7b9ee-278e-49f1-7dee-2e6186ab3cb8	stud12
\.


--
-- Data for Name: sys_groups; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY sys_groups (id, name) FROM stdin;
8a83161a-56fe-4e78-6a2d-cc1ceeadf761	1
1757d4cd-b661-4afc-63c0-d562b866b7e3	3
56ece860-65c1-46a1-7e0f-cf6a2a446359	2
8d391e82-759a-4992-507f-d8e9f943220c	5
70959605-c4d9-41c3-be33-f151e72365b5	Отдел_2
e7ba5167-8899-4adb-7e45-4da0ccdf59fa	4
fc6ae330-4a2d-40b6-a46c-fb23a9fd83e2	Отдел_1
3294a3ba-ccca-4e15-4aa8-b9d7d17894dc	Главный
\.


--
-- Data for Name: sys_groups_struct; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY sys_groups_struct (group_id, parent_id, level) FROM stdin;
8a83161a-56fe-4e78-6a2d-cc1ceeadf761	1757d4cd-b661-4afc-63c0-d562b866b7e3	1
1757d4cd-b661-4afc-63c0-d562b866b7e3	e7ba5167-8899-4adb-7e45-4da0ccdf59fa	1
8a83161a-56fe-4e78-6a2d-cc1ceeadf761	e7ba5167-8899-4adb-7e45-4da0ccdf59fa	2
e7ba5167-8899-4adb-7e45-4da0ccdf59fa	8d391e82-759a-4992-507f-d8e9f943220c	1
1757d4cd-b661-4afc-63c0-d562b866b7e3	8d391e82-759a-4992-507f-d8e9f943220c	2
8a83161a-56fe-4e78-6a2d-cc1ceeadf761	8d391e82-759a-4992-507f-d8e9f943220c	3
fc6ae330-4a2d-40b6-a46c-fb23a9fd83e2	3294a3ba-ccca-4e15-4aa8-b9d7d17894dc	1
\.


--
-- Data for Name: sys_users; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY sys_users (id, id_group, id_parent, "position", name) FROM stdin;
admin	\N	\N	Admin	Admin
stid2	\N	\N	Студент	Stud2
stud12	\N	\N	Студент	Dima
\.


--
-- Data for Name: test; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY test (num, rule) FROM stdin;
1	\N
3	4e3e5ce2-4109-4c2d-adf2-3a215035bb22
22	999e5ce2-4109-4c2d-adf2-3a215035bb22
\.


--
-- Data for Name: test_table_protected; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY test_table_protected (field1, field2, rule) FROM stdin;
\.


--
-- Data for Name: testtable_protected; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY testtable_protected (name, rule) FROM stdin;
\.


--
-- Name: pk_rule; Type: CONSTRAINT; Schema: public; Owner: postgres; Tablespace: 
--

ALTER TABLE ONLY rules
    ADD CONSTRAINT pk_rule PRIMARY KEY (rule);


--
-- Name: fki_rule; Type: INDEX; Schema: public; Owner: postgres; Tablespace: 
--

CREATE INDEX fki_rule ON rules_p USING btree (rule);


--
-- Name: fk_rule; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY rules_p
    ADD CONSTRAINT fk_rule FOREIGN KEY (rule) REFERENCES rules(rule);


--
-- Name: public; Type: ACL; Schema: -; Owner: postgres
--

REVOKE ALL ON SCHEMA public FROM PUBLIC;
REVOKE ALL ON SCHEMA public FROM postgres;
GRANT ALL ON SCHEMA public TO postgres;
GRANT ALL ON SCHEMA public TO PUBLIC;


--
-- Name: test_table_protected; Type: ACL; Schema: public; Owner: postgres
--

REVOKE ALL ON TABLE test_table_protected FROM PUBLIC;
REVOKE ALL ON TABLE test_table_protected FROM postgres;


--
-- Name: test_table; Type: ACL; Schema: public; Owner: postgres
--

REVOKE ALL ON TABLE test_table FROM PUBLIC;
REVOKE ALL ON TABLE test_table FROM postgres;
GRANT ALL ON TABLE test_table TO postgres;
GRANT ALL ON TABLE test_table TO student1;


--
-- Name: testtable_protected; Type: ACL; Schema: public; Owner: postgres
--

REVOKE ALL ON TABLE testtable_protected FROM PUBLIC;
REVOKE ALL ON TABLE testtable_protected FROM postgres;


--
-- Name: testtable; Type: ACL; Schema: public; Owner: postgres
--

REVOKE ALL ON TABLE testtable FROM PUBLIC;
REVOKE ALL ON TABLE testtable FROM postgres;
GRANT ALL ON TABLE testtable TO postgres;


--
-- PostgreSQL database dump complete
--

